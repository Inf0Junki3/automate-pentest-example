variable "assessment_name" {
  type = string
}

terraform {
  required_providers {
    docker = {
      source  = "kreuzwerker/docker"
      version = "3.0.1"
    }
  }
}

# The local docker provider
provider "docker" {
  host = "unix:///var/run/docker.sock"
}

# Pulls the image
resource "docker_image" "spiderfoot" {
  name = "spiderfoot"
  keep_locally = true
}

# Create a container
resource "docker_container" "recon_container" {
  image = docker_image.spiderfoot.image_id
  name  = var.assessment_name
  ports {
    internal = 5001
    external = 5001
    ip = "127.0.0.1"
  }
}